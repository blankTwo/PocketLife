# ğŸ“‹ ç”µå­å® ç‰©å°ç¨‹åº MVP ä»»åŠ¡æ¸…å•

> æŒ‰å¼€å‘æµç¨‹åˆ’åˆ†ï¼Œå…ˆè·‘é€šæ ¸å¿ƒé—­ç¯ï¼Œå†é€æ­¥å®Œå–„

---

## é˜¶æ®µä¸€ï¼šé¡¹ç›®åˆå§‹åŒ–

### 1.1 å¼€å‘ç¯å¢ƒæ­å»º
- [x] åˆå§‹åŒ– Taro 4.x é¡¹ç›®ï¼ˆReact + TypeScriptï¼‰
- [x] é…ç½®å¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘ç¯å¢ƒ
- [x] é…ç½® Zustand çŠ¶æ€ç®¡ç†
- [ ] é…ç½® ESLint + Prettier ä»£ç è§„èŒƒ

### 1.2 é¡¹ç›®ç»“æ„è§„åˆ’
- [x] åˆ›å»ºç›®å½•ç»“æ„ï¼ˆpages / components / store / services / utilsï¼‰
- [x] åˆ›å»ºäº‘å‡½æ•°ç›®å½•ç»“æ„
- [x] å®šä¹‰ TypeScript ç±»å‹æ–‡ä»¶ï¼ˆPet å®ä½“ç­‰ï¼‰

### 1.3 äº‘æ•°æ®åº“è®¾è®¡
- [ ] åˆ›å»º pets é›†åˆï¼ˆéœ€åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰‹åŠ¨åˆ›å»ºï¼‰
- [ ] è®¾ç½® openid å”¯ä¸€ç´¢å¼•ï¼ˆéœ€åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰‹åŠ¨åˆ›å»ºï¼‰
- [x] å®šä¹‰å­—æ®µç»“æ„åŠåˆå§‹å€¼

---

## é˜¶æ®µäºŒï¼šæ ¸å¿ƒé—­ç¯ï¼ˆæœ€å°å¯è¿è¡Œç‰ˆæœ¬ï¼‰

### 2.1 äº‘å‡½æ•° - åŸºç¡€æ¥å£
- [x] getPetï¼šè·å–/åˆ›å»ºå® ç‰©ï¼ˆå«æ—¶é—´ç»“ç®— + æ­»äº¡æ£€æµ‹ + è¿›åŒ–æ£€æµ‹ï¼‰
- [x] doActionï¼šæ‰§è¡Œè¡Œä¸ºï¼ˆå–‚é£Ÿ/ç©è€/ç¡è§‰ï¼‰
- [x] rebornï¼šé‡ç”Ÿæ¥å£

### 2.2 æ ¸å¿ƒå·¥å…·å‡½æ•°
- [x] settle()ï¼šæ—¶é—´è¡°å‡ç»“ç®—
- [x] checkDeath()ï¼šæ­»äº¡åˆ¤å®š
- [x] checkEvolution()ï¼šè¿›åŒ–åˆ¤å®š
- [x] clamp()ï¼šæ•°å€¼è¾¹ç•Œå¤„ç†

### 2.3 å‰ç«¯ - ä¸»é¡µé¢
- [x] å® ç‰©çŠ¶æ€å±•ç¤ºï¼ˆhunger / mood / energy æ•°å€¼ï¼‰
- [x] ä¸‰ä¸ªè¡Œä¸ºæŒ‰é’®ï¼ˆå–‚é£Ÿ / ç©è€ / ç¡è§‰ï¼‰
- [x] æŒ‰é’®ç‚¹å‡»è°ƒç”¨äº‘å‡½æ•°
- [x] çŠ¶æ€æ›´æ–°ååˆ·æ–° UI
- [x] Canvas å® ç‰©åŠ¨ç”»ï¼ˆè¡¨æƒ… + åŠ¨ä½œåŠ¨ç”»ï¼‰

### 2.4 å‰ç«¯ - çŠ¶æ€ç®¡ç†
- [x] Zustand store è®¾è®¡ï¼ˆpetStoreï¼‰
- [x] å® ç‰©æ•°æ®è·å–ä¸ç¼“å­˜
- [x] loading / error çŠ¶æ€å¤„ç†

### 2.5 é—­ç¯éªŒè¯
- [ ] è¿›å…¥å°ç¨‹åº â†’ æ˜¾ç¤ºå® ç‰©çŠ¶æ€ï¼ˆå¾…å®æœºæµ‹è¯•ï¼‰
- [ ] ç‚¹å‡»æŒ‰é’® â†’ æ•°å€¼å˜åŒ–ï¼ˆå¾…å®æœºæµ‹è¯•ï¼‰
- [ ] å…³é—­å†æ‰“å¼€ â†’ æ—¶é—´è¡°å‡ç”Ÿæ•ˆï¼ˆå¾…å®æœºæµ‹è¯•ï¼‰

---

## é˜¶æ®µä¸‰ï¼šåŠŸèƒ½å®Œå–„

### 3.1 å® ç‰©åˆ›å»ºæµç¨‹
- [ ] æ–°ç”¨æˆ·å¼•å¯¼é¡µ
- [ ] å® ç‰©å‘½åè¾“å…¥ï¼ˆ2~6 å­—ç¬¦é™åˆ¶ï¼‰
- [ ] åˆ›å»ºæˆåŠŸè·³è½¬ä¸»é¡µ

### 3.2 æ­»äº¡ä¸é‡ç”Ÿ
- [x] æ­»äº¡çŠ¶æ€ UIï¼ˆç¦ç”¨æŒ‰é’® + æç¤ºæ–‡æ¡ˆï¼‰
- [x] é‡æ–°å¼€å§‹æŒ‰é’®
- [x] é‡ç”Ÿåé‡ç½®çŠ¶æ€

### 3.3 è¿›åŒ–ç³»ç»Ÿ
- [x] è¿›åŒ–é˜¶æ®µå±•ç¤ºï¼ˆbaby / adult / masterï¼‰
- [ ] è¿›åŒ–æ—¶çš„ UI åé¦ˆï¼ˆå¯é€‰ï¼šç®€å•æç¤ºï¼‰

### 3.4 è¡Œä¸ºå†·å´
- [x] å…¨å±€ 5s å†·å´é€»è¾‘
- [ ] æŒ‰é’®ç½®ç° + å€’è®¡æ—¶æç¤ºï¼ˆç›®å‰åªæœ‰ç½®ç°ï¼Œæ— å€’è®¡æ—¶ï¼‰

### 3.5 UI çŠ¶æ€æ˜ å°„
- [x] ä¸‰çº§çŠ¶æ€è¡¨ç°ï¼ˆå±é™© / ä¸€èˆ¬ / è‰¯å¥½ï¼‰
- [x] æ•°å€¼å¯¹åº”é¢œè‰²æˆ–è¡¨æƒ…å˜åŒ–

---

## é˜¶æ®µå››ï¼šä¼˜åŒ–æ”¶å°¾

### 4.1 å¼‚å¸¸å¤„ç†
- [x] å‰ç«¯æŒ‰é’®é˜²æŠ–ï¼ˆé€šè¿‡ cooldown å®ç°ï¼‰
- [ ] äº‘å‡½æ•°è¶…æ—¶å¤„ç†ï¼ˆ10sï¼‰
- [x] ç»Ÿä¸€é”™è¯¯æç¤º UI

### 4.2 å¹¶å‘æ§åˆ¶
- [x] äº‘å‡½æ•°ä¹è§‚é”å®ç°
- [ ] ç‰ˆæœ¬å·å†²çªé‡è¯•

### 4.3 ä½“éªŒä¼˜åŒ–
- [x] æ“ä½œ loading æ€
- [x] æ•°å€¼å˜åŒ–åŠ¨ç”»ï¼ˆCanvas åŠ¨ç”»ï¼‰
- [x] é¡µé¢ onShow è‡ªåŠ¨åˆ·æ–°çŠ¶æ€

### 4.4 ä»£ç è´¨é‡
- [x] å…³é”®é€»è¾‘ä¸­æ–‡æ³¨é‡Š
- [x] ç±»å‹å®šä¹‰å®Œå–„
- [x] åˆ é™¤æ— ç”¨ä»£ç 

---

---

## é˜¶æ®µäº”ï¼šæ•°æ®åº“æ¶æ„å‡çº§ï¼ˆV1.5 å‡†å¤‡ï¼‰

> ä¸ºåç»­å¤šå® ç‰©ã€å•†åŸç­‰åŠŸèƒ½åšæ¶æ„å‡†å¤‡

### 5.1 æ•°æ®åº“è¡¨è®¾è®¡
- [ ] è®¾è®¡ users è¡¨ç»“æ„ï¼ˆç”¨æˆ·åŸºç¡€ä¿¡æ¯ã€è´§å¸ã€ç­‰çº§ï¼‰
- [ ] è®¾è®¡ pets è¡¨æ”¹é€ æ–¹æ¡ˆï¼ˆæ”¯æŒå¤šå® ç‰©ï¼‰
- [ ] è®¾è®¡ items è¡¨ç»“æ„ï¼ˆç‰©å“æ¨¡æ¿å®šä¹‰ï¼‰
- [ ] è®¾è®¡ user_items è¡¨ç»“æ„ï¼ˆç”¨æˆ·èƒŒåŒ…ï¼‰
- [ ] è®¾è®¡ transactions è¡¨ç»“æ„ï¼ˆäº¤æ˜“æµæ°´ï¼‰
- [ ] è®¾è®¡ achievements è¡¨ç»“æ„ï¼ˆæˆå°±ç³»ç»Ÿï¼Œå¯é€‰ï¼‰
- [ ] ç¼–å†™æ•°æ®åº“è®¾è®¡æ–‡æ¡£

### 5.2 æ•°æ®è¿ç§»å‡†å¤‡
- [ ] ç¼–å†™æ•°æ®è¿ç§»è„šæœ¬ï¼ˆå•å® ç‰© â†’ å¤šå® ç‰©æ¶æ„ï¼‰
- [ ] æµ‹è¯•è¿ç§»è„šæœ¬ï¼ˆä½¿ç”¨æµ‹è¯•æ•°æ®ï¼‰
- [ ] åˆ¶å®šè¿ç§»å›æ»šæ–¹æ¡ˆ
- [ ] ç¼–å†™è¿ç§»æ“ä½œæ–‡æ¡£

---

## é˜¶æ®µå…­ï¼šå¤šå® ç‰©ç³»ç»Ÿï¼ˆV1.5ï¼‰

> æ”¶é›†å…»æˆå‹ç©æ³•ï¼Œæå‡å¯ç©æ€§

### 6.1 æ•°æ®åº“å®æ–½
- [ ] åˆ›å»º users é›†åˆ
- [ ] æ”¹é€  pets é›†åˆï¼ˆæ·»åŠ  slotIndexã€petType ç­‰å­—æ®µï¼‰
- [ ] è®¾ç½®æ–°ç´¢å¼•ï¼ˆopenid æ™®é€šç´¢å¼•ã€å¤åˆå”¯ä¸€ç´¢å¼•ï¼‰
- [ ] æ‰§è¡Œæ•°æ®è¿ç§»ï¼ˆç°æœ‰ç”¨æˆ·æ•°æ®ï¼‰

### 6.2 å® ç‰©ç§ç±»è®¾è®¡
- [ ] å®šä¹‰ 3 ç§å® ç‰©ç±»å‹ï¼ˆçŒ«/ç‹—/å…”å­ï¼‰
- [ ] è®¾è®¡å·®å¼‚åŒ–å±æ€§ï¼ˆè¡°å‡é€Ÿåº¦ã€è¿›åŒ–æ¡ä»¶ï¼‰
- [ ] è®¾è®¡å® ç‰©å¤–è§‚ï¼ˆCanvas ç»˜åˆ¶ä¸åŒå½¢çŠ¶ï¼‰
- [ ] é…ç½®å® ç‰©é¢œè‰²å’Œå¤§å°

### 6.3 äº‘å‡½æ•°å¼€å‘
- [ ] æ”¹é€  getPetï¼ˆæ”¯æŒè·å–æ¿€æ´»å® ç‰©ï¼‰
- [ ] æ–°å¢ createPetï¼ˆåˆ›å»ºæ–°å® ç‰©ï¼‰
- [ ] æ–°å¢ listPetsï¼ˆè·å–ç”¨æˆ·æ‰€æœ‰å® ç‰©ï¼‰
- [ ] æ–°å¢ switchPetï¼ˆåˆ‡æ¢æ¿€æ´»å® ç‰©ï¼‰
- [ ] æ”¹é€  doActionï¼ˆæ“ä½œæŒ‡å®šå® ç‰©ï¼‰
- [ ] æ”¹é€  rebornï¼ˆé‡ç”ŸæŒ‡å®šå® ç‰©ï¼‰

### 6.4 å‰ç«¯é¡µé¢å¼€å‘
- [ ] å® ç‰©åˆ—è¡¨é¡µï¼ˆå±•ç¤ºæ‰€æœ‰å® ç‰©æ§½ä½ï¼‰
- [ ] å® ç‰©åˆ›å»ºé¡µï¼ˆé€‰æ‹©ç§ç±» + å‘½åï¼‰
- [ ] ä¸»é¡µå¢åŠ "åˆ‡æ¢å® ç‰©"å…¥å£
- [ ] æ§½ä½è§£é”æç¤º UI
- [ ] å® ç‰©ç§ç±»å›¾æ ‡å±•ç¤º

### 6.5 æ§½ä½è§£é”æœºåˆ¶
- [ ] æ§½ä½ 0ï¼šé»˜è®¤è§£é”ï¼ˆåˆå§‹å® ç‰©ï¼‰
- [ ] æ§½ä½ 1ï¼šä¸»å® ç‰©è¾¾åˆ° adult è§£é”
- [ ] æ§½ä½ 2ï¼šä¸»å® ç‰©è¾¾åˆ° master è§£é”
- [ ] è§£é”æç¤ºå’Œå¼•å¯¼

### 6.6 éæ¿€æ´»å® ç‰©å¤„ç†
- [ ] éæ¿€æ´»å® ç‰©ä¼‘çœ ï¼ˆä¸è¡°å‡ï¼‰
- [ ] åˆ‡æ¢å® ç‰©æ—¶ç»“ç®—æ—¶é—´
- [ ] æ­»äº¡å® ç‰©æç¤ºå’Œå¤„ç†

---

## é˜¶æ®µä¸ƒï¼šç‰©å“ç³»ç»Ÿï¼ˆV2.0ï¼‰

> ä¸ºå•†åŸã€è£…å¤‡ç­‰åŠŸèƒ½æ‰“åŸºç¡€

### 7.1 æ•°æ®åº“å®æ–½
- [ ] åˆ›å»º items é›†åˆï¼ˆç‰©å“æ¨¡æ¿ï¼‰
- [ ] åˆ›å»º user_items é›†åˆï¼ˆç”¨æˆ·èƒŒåŒ…ï¼‰
- [ ] åˆ›å»º transactions é›†åˆï¼ˆäº¤æ˜“è®°å½•ï¼‰
- [ ] è®¾ç½®ç›¸å…³ç´¢å¼•

### 7.2 ç‰©å“å®šä¹‰
- [ ] è®¾è®¡é£Ÿç‰©ç±»ç‰©å“ï¼ˆé«˜çº§çŒ«ç²®ã€é›¶é£Ÿç­‰ï¼‰
- [ ] è®¾è®¡ç©å…·ç±»ç‰©å“ï¼ˆé€—çŒ«æ£’ã€é£ç›˜ç­‰ï¼‰
- [ ] è®¾è®¡è¯å“ç±»ç‰©å“ï¼ˆè¥å…»æ¶²ã€æ²»ç–—è¯ç­‰ï¼‰
- [ ] é…ç½®ç‰©å“æ•ˆæœå’Œä»·æ ¼
- [ ] å¯¼å…¥ç‰©å“æ•°æ®åˆ° items è¡¨

### 7.3 äº‘å‡½æ•°å¼€å‘
- [ ] æ–°å¢ useItemï¼ˆä½¿ç”¨ç‰©å“ï¼‰
- [ ] æ–°å¢ getUserItemsï¼ˆè·å–ç”¨æˆ·èƒŒåŒ…ï¼‰
- [ ] ç‰©å“æ•ˆæœè®¡ç®—é€»è¾‘
- [ ] ç‰©å“å†·å´æœºåˆ¶
- [ ] ç‰©å“æ¶ˆè€—å’Œæ•°é‡ç®¡ç†

### 7.4 å‰ç«¯é¡µé¢å¼€å‘
- [ ] èƒŒåŒ…é¡µé¢ï¼ˆå±•ç¤ºæ‹¥æœ‰çš„ç‰©å“ï¼‰
- [ ] ç‰©å“ä½¿ç”¨ç•Œé¢
- [ ] ç‰©å“æ•ˆæœåŠ¨ç”»
- [ ] ç‰©å“æ•°é‡æ˜¾ç¤º

---

## é˜¶æ®µå…«ï¼šå•†åŸç³»ç»Ÿï¼ˆV2.0ï¼‰

> è´§å¸ç³»ç»Ÿå’Œç‰©å“è´­ä¹°

### 8.1 è´§å¸ç³»ç»Ÿ
- [ ] users è¡¨æ·»åŠ è´§å¸å­—æ®µï¼ˆcoinsã€diamondsï¼‰
- [ ] åˆå§‹è´§å¸èµ é€é€»è¾‘
- [ ] è´§å¸è·å–é€”å¾„è®¾è®¡ï¼ˆæ¯æ—¥ç™»å½•ã€æˆå°±ç­‰ï¼‰

### 8.2 äº‘å‡½æ•°å¼€å‘
- [ ] æ–°å¢ purchaseItemï¼ˆè´­ä¹°ç‰©å“ï¼‰
- [ ] æ–°å¢ getShopItemsï¼ˆè·å–å•†åŸç‰©å“åˆ—è¡¨ï¼‰
- [ ] äº¤æ˜“è®°å½•å†™å…¥ transactions è¡¨
- [ ] è´§å¸æ‰£é™¤å’Œä½™é¢æ£€æŸ¥
- [ ] å¹¶å‘è´­ä¹°æ§åˆ¶ï¼ˆä¹è§‚é”ï¼‰

### 8.3 å‰ç«¯é¡µé¢å¼€å‘
- [ ] å•†åŸé¡µé¢ï¼ˆå±•ç¤ºå¯è´­ä¹°ç‰©å“ï¼‰
- [ ] ç‰©å“è¯¦æƒ…å¼¹çª—
- [ ] è´­ä¹°ç¡®è®¤å¼¹çª—
- [ ] è´§å¸ä½™é¢æ˜¾ç¤º
- [ ] è´­ä¹°æˆåŠŸåŠ¨ç”»

### 8.4 å•†åŸè¿è¥
- [ ] ç‰©å“ä¸Šä¸‹æ¶ç®¡ç†
- [ ] é™æ—¶æŠ˜æ‰£åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰
- [ ] æ¯æ—¥ç‰¹æƒ ï¼ˆå¯é€‰ï¼‰

---

## é˜¶æ®µä¹ï¼šæˆå°±ç³»ç»Ÿï¼ˆV2.5ï¼Œå¯é€‰ï¼‰

> å¢åŠ é•¿æœŸç›®æ ‡å’Œå¥–åŠ±

### 9.1 æ•°æ®åº“å®æ–½
- [ ] åˆ›å»º achievements é›†åˆï¼ˆæˆå°±å®šä¹‰ï¼‰
- [ ] åˆ›å»º user_achievements é›†åˆï¼ˆç”¨æˆ·æˆå°±è¿›åº¦ï¼‰
- [ ] è®¾ç½®ç›¸å…³ç´¢å¼•

### 9.2 æˆå°±è®¾è®¡
- [ ] å® ç‰©ç›¸å…³æˆå°±ï¼ˆè·å¾—é¦–åªå® ç‰©ã€è¿›åŒ–ç­‰ï¼‰
- [ ] è¡Œä¸ºç›¸å…³æˆå°±ï¼ˆå–‚é£Ÿ N æ¬¡ã€ç©è€ N æ¬¡ç­‰ï¼‰
- [ ] æ”¶é›†ç›¸å…³æˆå°±ï¼ˆæ‹¥æœ‰ 3 åªå® ç‰©ã€æ”¶é›†æ‰€æœ‰ç§ç±»ç­‰ï¼‰
- [ ] é…ç½®æˆå°±å¥–åŠ±

### 9.3 äº‘å‡½æ•°å¼€å‘
- [ ] æ–°å¢ checkAchievementsï¼ˆæ£€æµ‹æˆå°±å®Œæˆï¼‰
- [ ] æ–°å¢ claimAchievementRewardï¼ˆé¢†å–æˆå°±å¥–åŠ±ï¼‰
- [ ] æ–°å¢ getUserAchievementsï¼ˆè·å–ç”¨æˆ·æˆå°±åˆ—è¡¨ï¼‰
- [ ] æˆå°±è¿›åº¦è‡ªåŠ¨æ›´æ–°é€»è¾‘

### 9.4 å‰ç«¯é¡µé¢å¼€å‘
- [ ] æˆå°±é¡µé¢ï¼ˆå±•ç¤ºæ‰€æœ‰æˆå°±ï¼‰
- [ ] æˆå°±å®Œæˆæç¤º
- [ ] æˆå°±å¥–åŠ±é¢†å–ç•Œé¢
- [ ] æˆå°±è¿›åº¦æ¡å±•ç¤º

---

## é˜¶æ®µåï¼šæ¯æ—¥ä»»åŠ¡ç³»ç»Ÿï¼ˆV3.0ï¼Œå¯é€‰ï¼‰

> æå‡æ—¥æ´»å’Œç•™å­˜

### 10.1 æ•°æ®åº“å®æ–½
- [ ] åˆ›å»º daily_tasks é›†åˆ
- [ ] è®¾ç½®ç›¸å…³ç´¢å¼•

### 10.2 ä»»åŠ¡è®¾è®¡
- [ ] æ¯æ—¥ä»»åŠ¡åˆ—è¡¨ï¼ˆå–‚é£Ÿ 3 æ¬¡ã€ç©è€ 5 æ¬¡ç­‰ï¼‰
- [ ] ä»»åŠ¡åˆ·æ–°æœºåˆ¶ï¼ˆæ¯æ—¥ 0 ç‚¹ï¼‰
- [ ] ä»»åŠ¡å¥–åŠ±é…ç½®

### 10.3 äº‘å‡½æ•°å¼€å‘
- [ ] æ–°å¢ getDailyTasksï¼ˆè·å–æ¯æ—¥ä»»åŠ¡ï¼‰
- [ ] æ–°å¢ claimTaskRewardï¼ˆé¢†å–ä»»åŠ¡å¥–åŠ±ï¼‰
- [ ] ä»»åŠ¡è¿›åº¦è‡ªåŠ¨æ›´æ–°
- [ ] ä»»åŠ¡åˆ·æ–°å®šæ—¶å™¨

### 10.4 å‰ç«¯é¡µé¢å¼€å‘
- [ ] æ¯æ—¥ä»»åŠ¡é¡µé¢
- [ ] ä»»åŠ¡è¿›åº¦å±•ç¤º
- [ ] ä»»åŠ¡å®Œæˆæç¤º
- [ ] ä»»åŠ¡å¥–åŠ±é¢†å–

---

## ğŸ“ è¡¥å……è¯´æ˜

### V1 è¾¹ç•Œï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰
- âœ… å•å® ç‰©å…»æˆ
- âœ… åŸºç¡€è¡Œä¸ºç³»ç»Ÿ
- âœ… æ—¶é—´è¡°å‡æœºåˆ¶
- âœ… è¿›åŒ–ç³»ç»Ÿ
- âœ… æ­»äº¡ä¸é‡ç”Ÿ

### V1.5 è§„åˆ’ï¼ˆå¤šå® ç‰©ï¼‰
- ğŸ”„ æ•°æ®åº“æ¶æ„å‡çº§
- ğŸ”„ å¤šå® ç‰©ç³»ç»Ÿï¼ˆ3 æ§½ä½ï¼‰
- ğŸ”„ å® ç‰©ç§ç±»å·®å¼‚åŒ–

### V2.0 è§„åˆ’ï¼ˆç‰©å“ä¸å•†åŸï¼‰
- â³ ç‰©å“ç³»ç»Ÿ
- â³ å•†åŸç³»ç»Ÿ
- â³ è´§å¸ç³»ç»Ÿ

### V2.5+ è§„åˆ’ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
- â³ æˆå°±ç³»ç»Ÿ
- â³ æ¯æ—¥ä»»åŠ¡
- â³ å¥½å‹ç¤¾äº¤
- â³ è£…å¤‡çš®è‚¤

### æŠ€æœ¯çº¦å®š
- æ•°å€¼å­˜å‚¨å–æ•´ï¼ˆMath.floorï¼‰
- æœåŠ¡å™¨æ—¶é—´ä¼˜å…ˆ
- ä¸¥ç¦å‰ç«¯ç›´æ¥ä¿®æ”¹æ•°å€¼

### ç”¨æˆ·æ•°æ®éš”ç¦»
- ä½¿ç”¨å¾®ä¿¡ç”¨æˆ· **openid** ä½œä¸ºå”¯ä¸€æ ‡è¯†
- äº‘å‡½æ•°é€šè¿‡ `cloud.getWXContext().OPENID` è·å–
- ä¸€ä¸ª openid å¯¹åº”ä¸€åªå® ç‰©
- æ•°æ®åº“æŸ¥è¯¢å¿…é¡»å¸¦ openid æ¡ä»¶ï¼Œç¡®ä¿ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®

---

## ğŸ“Š æ•°æ®åº“æ¶æ„è®¾è®¡ï¼ˆV1.5+ ç‰ˆæœ¬ï¼‰

### è¡¨ç»“æ„æ€»è§ˆ

```
users (ç”¨æˆ·è¡¨) - ç”¨æˆ·åŸºç¡€ä¿¡æ¯å’Œè´§å¸
  â”œâ”€ 1:N â†’ pets (å® ç‰©è¡¨) - å® ç‰©çŠ¶æ€æ•°æ®
  â”œâ”€ 1:N â†’ user_items (ç”¨æˆ·èƒŒåŒ…) - æ‹¥æœ‰çš„ç‰©å“
  â”œâ”€ 1:N â†’ transactions (äº¤æ˜“è®°å½•) - è´§å¸å’Œç‰©å“æµæ°´
  â”œâ”€ 1:N â†’ user_achievements (ç”¨æˆ·æˆå°±) - æˆå°±è¿›åº¦
  â””â”€ 1:N â†’ daily_tasks (æ¯æ—¥ä»»åŠ¡) - ä»»åŠ¡è¿›åº¦

items (ç‰©å“æ¨¡æ¿) - ç‰©å“å®šä¹‰ï¼ˆé™æ€æ•°æ®ï¼‰
  â””â”€ 1:N â†’ user_items

achievements (æˆå°±æ¨¡æ¿) - æˆå°±å®šä¹‰ï¼ˆé™æ€æ•°æ®ï¼‰
  â””â”€ 1:N â†’ user_achievements
```

---

### users è¡¨ï¼ˆç”¨æˆ·åŸºç¡€ä¿¡æ¯ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| openid | string | æ˜¯ | å¾®ä¿¡ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆå”¯ä¸€ç´¢å¼•ï¼‰ |
| nickname | string | å¦ | ç”¨æˆ·æ˜µç§° |
| avatarUrl | string | å¦ | ç”¨æˆ·å¤´åƒ |
| level | number | æ˜¯ | ç”¨æˆ·ç­‰çº§ï¼Œé»˜è®¤ 1 |
| exp | number | æ˜¯ | ç»éªŒå€¼ï¼Œé»˜è®¤ 0 |
| coins | number | æ˜¯ | é‡‘å¸ï¼ˆæ¸¸æˆå†…è´§å¸ï¼‰ï¼Œé»˜è®¤ 100 |
| diamonds | number | æ˜¯ | é’»çŸ³ï¼ˆä»˜è´¹è´§å¸ï¼‰ï¼Œé»˜è®¤ 0 |
| activePetId | string | å¦ | å½“å‰æ¿€æ´»çš„å® ç‰© ID |
| unlockedSlots | array | æ˜¯ | å·²è§£é”çš„æ§½ä½æ•°ç»„ï¼Œé»˜è®¤ [0] |
| maxSlots | number | æ˜¯ | æœ€å¤§æ§½ä½æ•°ï¼Œé»˜è®¤ 3 |
| totalPets | number | æ˜¯ | æ‹¥æœ‰çš„å® ç‰©æ€»æ•°ï¼Œé»˜è®¤ 0 |
| totalActions | number | æ˜¯ | æ€»æ“ä½œæ¬¡æ•°ï¼Œé»˜è®¤ 0 |
| createdAt | number | æ˜¯ | åˆ›å»ºæ—¶é—´æˆ³ |
| lastLoginAt | number | æ˜¯ | æœ€åç™»å½•æ—¶é—´æˆ³ |
| version | number | æ˜¯ | ç‰ˆæœ¬å·ï¼ˆä¹è§‚é”ï¼‰ï¼Œé»˜è®¤ 0 |

**ç´¢å¼•ï¼š**
- å”¯ä¸€ç´¢å¼•ï¼šopenid

---

### pets è¡¨ï¼ˆå® ç‰©æ•°æ®ï¼‰- V1.5 æ”¹é€ 

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| openid | string | æ˜¯ | æ‰€å±ç”¨æˆ·ï¼ˆæ™®é€šç´¢å¼•ï¼‰ |
| slotIndex | number | æ˜¯ | æ§½ä½ç¼–å· 0-2 |
| petType | string | æ˜¯ | å® ç‰©ç§ç±»ï¼šcat/dog/rabbit |
| name | string | æ˜¯ | å® ç‰©åç§°ï¼ˆ2~6 å­—ç¬¦ï¼‰ |
| stage | string | æ˜¯ | è¿›åŒ–é˜¶æ®µï¼šbaby/adult/master |
| hunger | number | æ˜¯ | é¥¥é¥¿å€¼ï¼ˆ0~100ï¼‰ |
| mood | number | æ˜¯ | å¿ƒæƒ…å€¼ï¼ˆ0~100ï¼‰ |
| energy | number | æ˜¯ | ç²¾åŠ›å€¼ï¼ˆ0~100ï¼‰ |
| health | number | æ˜¯ | å¥åº·å€¼ï¼ˆ0~100ï¼‰ï¼Œé»˜è®¤ 100 |
| cleanliness | number | æ˜¯ | æ¸…æ´åº¦ï¼ˆ0~100ï¼‰ï¼Œé»˜è®¤ 100 |
| lastUpdate | number | æ˜¯ | ä¸Šæ¬¡ç»“ç®—æ—¶é—´æˆ³ |
| lastActionAt | number | æ˜¯ | ä¸Šæ¬¡æ“ä½œæ—¶é—´æˆ³ |
| createdAt | number | æ˜¯ | å® ç‰©åˆ›å»ºæ—¶é—´æˆ³ |
| goodStateStartAt | number | å¦ | é«˜çŠ¶æ€èµ·å§‹æ—¶é—´ |
| dead | boolean | æ˜¯ | æ˜¯å¦æ­»äº¡ï¼Œé»˜è®¤ false |
| deadAt | number | å¦ | æ­»äº¡æ—¶é—´æˆ³ |
| totalFeedCount | number | æ˜¯ | å–‚é£Ÿæ¬¡æ•°ï¼Œé»˜è®¤ 0 |
| totalPlayCount | number | æ˜¯ | ç©è€æ¬¡æ•°ï¼Œé»˜è®¤ 0 |
| totalSleepCount | number | æ˜¯ | ç¡è§‰æ¬¡æ•°ï¼Œé»˜è®¤ 0 |
| totalAliveTime | number | æ˜¯ | å­˜æ´»æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 0 |
| equippedItems | array | æ˜¯ | å·²è£…å¤‡çš„ç‰©å“ ID æ•°ç»„ï¼Œé»˜è®¤ [] |
| skinId | string | å¦ | å½“å‰çš®è‚¤ ID |
| version | number | æ˜¯ | ç‰ˆæœ¬å·ï¼ˆä¹è§‚é”ï¼‰ï¼Œé»˜è®¤ 0 |

**ç´¢å¼•ï¼š**
- æ™®é€šç´¢å¼•ï¼šopenid
- å¤åˆå”¯ä¸€ç´¢å¼•ï¼š(openid, slotIndex)
- æ™®é€šç´¢å¼•ï¼šdead

---

### items è¡¨ï¼ˆç‰©å“æ¨¡æ¿å®šä¹‰ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| itemId | string | æ˜¯ | ç‰©å“å”¯ä¸€æ ‡è¯†ï¼ˆå”¯ä¸€ç´¢å¼•ï¼‰ |
| name | string | æ˜¯ | ç‰©å“åç§° |
| description | string | æ˜¯ | ç‰©å“æè¿° |
| category | string | æ˜¯ | ç±»åˆ«ï¼šfood/toy/medicine/skin/decoration |
| subCategory | string | å¦ | å­ç±»åˆ« |
| effects | object | æ˜¯ | ç‰©å“æ•ˆæœ {hunger, mood, energy, health} |
| targetPetTypes | array | å¦ | é€‚ç”¨å® ç‰©ç±»å‹ï¼Œnull = å…¨éƒ¨ |
| cooldown | number | æ˜¯ | å†·å´æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 0 |
| consumable | boolean | æ˜¯ | æ˜¯å¦æ¶ˆè€—å“ï¼Œé»˜è®¤ true |
| price | number | æ˜¯ | é‡‘å¸ä»·æ ¼ |
| diamondPrice | number | æ˜¯ | é’»çŸ³ä»·æ ¼ï¼Œé»˜è®¤ 0 |
| available | boolean | æ˜¯ | æ˜¯å¦åœ¨å•†åŸä¸Šæ¶ï¼Œé»˜è®¤ true |
| rarity | string | æ˜¯ | ç¨€æœ‰åº¦ï¼šcommon/rare/epic/legendary |
| icon | string | å¦ | å›¾æ ‡ URL |
| createdAt | number | æ˜¯ | åˆ›å»ºæ—¶é—´æˆ³ |

**ç´¢å¼•ï¼š**
- å”¯ä¸€ç´¢å¼•ï¼šitemId
- æ™®é€šç´¢å¼•ï¼šcategory

---

### user_items è¡¨ï¼ˆç”¨æˆ·èƒŒåŒ…ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| openid | string | æ˜¯ | æ‰€å±ç”¨æˆ·ï¼ˆæ™®é€šç´¢å¼•ï¼‰ |
| itemId | string | æ˜¯ | ç‰©å“æ¨¡æ¿ ID |
| quantity | number | æ˜¯ | æ•°é‡ |
| source | string | æ˜¯ | æ¥æºï¼špurchase/gift/achievement/daily |
| acquiredAt | number | æ˜¯ | è·å–æ—¶é—´æˆ³ |
| lastUsedAt | number | å¦ | æœ€åä½¿ç”¨æ—¶é—´æˆ³ |
| expiresAt | number | å¦ | è¿‡æœŸæ—¶é—´æˆ³ï¼Œnull = æ°¸ä¹… |

**ç´¢å¼•ï¼š**
- æ™®é€šç´¢å¼•ï¼šopenid
- å¤åˆç´¢å¼•ï¼š(openid, itemId)

---

### transactions è¡¨ï¼ˆäº¤æ˜“è®°å½•ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| openid | string | æ˜¯ | ç”¨æˆ·ï¼ˆæ™®é€šç´¢å¼•ï¼‰ |
| type | string | æ˜¯ | äº¤æ˜“ç±»å‹ï¼špurchase/consume/reward/gift |
| itemId | string | å¦ | ç‰©å“ IDï¼ˆå¦‚æœæ˜¯ç‰©å“äº¤æ˜“ï¼‰ |
| quantity | number | æ˜¯ | æ•°é‡ |
| coinsDelta | number | æ˜¯ | é‡‘å¸å˜åŒ–ï¼ˆè´Ÿæ•° = æ”¯å‡ºï¼‰ |
| diamondsDelta | number | æ˜¯ | é’»çŸ³å˜åŒ– |
| coinsAfter | number | æ˜¯ | äº¤æ˜“åé‡‘å¸ä½™é¢ |
| diamondsAfter | number | æ˜¯ | äº¤æ˜“åé’»çŸ³ä½™é¢ |
| relatedPetId | string | å¦ | å…³è”çš„å® ç‰© ID |
| createdAt | number | æ˜¯ | åˆ›å»ºæ—¶é—´æˆ³ |

**ç´¢å¼•ï¼š**
- æ™®é€šç´¢å¼•ï¼šopenid
- æ™®é€šç´¢å¼•ï¼štype
- å¤åˆç´¢å¼•ï¼š(openid, createdAt)

---

### achievements è¡¨ï¼ˆæˆå°±å®šä¹‰ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| achievementId | string | æ˜¯ | æˆå°±å”¯ä¸€æ ‡è¯†ï¼ˆå”¯ä¸€ç´¢å¼•ï¼‰ |
| name | string | æ˜¯ | æˆå°±åç§° |
| description | string | æ˜¯ | æˆå°±æè¿° |
| category | string | æ˜¯ | ç±»åˆ«ï¼špet/action/collection/social |
| condition | object | æ˜¯ | å®Œæˆæ¡ä»¶ {type, target} |
| rewards | object | æ˜¯ | å¥–åŠ± {coins, diamonds, items, unlockSlot} |
| rarity | string | æ˜¯ | ç¨€æœ‰åº¦ï¼šcommon/rare/epic/legendary |
| icon | string | å¦ | å›¾æ ‡ URL |
| hidden | boolean | æ˜¯ | æ˜¯å¦éšè—ï¼Œé»˜è®¤ false |

**ç´¢å¼•ï¼š**
- å”¯ä¸€ç´¢å¼•ï¼šachievementId

---

### user_achievements è¡¨ï¼ˆç”¨æˆ·æˆå°±è¿›åº¦ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| openid | string | æ˜¯ | ç”¨æˆ·ï¼ˆæ™®é€šç´¢å¼•ï¼‰ |
| achievementId | string | æ˜¯ | æˆå°± ID |
| progress | number | æ˜¯ | å½“å‰è¿›åº¦ |
| target | number | æ˜¯ | ç›®æ ‡è¿›åº¦ |
| completed | boolean | æ˜¯ | æ˜¯å¦å®Œæˆï¼Œé»˜è®¤ false |
| rewardClaimed | boolean | æ˜¯ | æ˜¯å¦å·²é¢†å–å¥–åŠ±ï¼Œé»˜è®¤ false |
| startedAt | number | æ˜¯ | å¼€å§‹æ—¶é—´æˆ³ |
| completedAt | number | å¦ | å®Œæˆæ—¶é—´æˆ³ |
| claimedAt | number | å¦ | é¢†å–æ—¶é—´æˆ³ |

**ç´¢å¼•ï¼š**
- å¤åˆç´¢å¼•ï¼š(openid, achievementId)
- æ™®é€šç´¢å¼•ï¼šcompleted

---

### daily_tasks è¡¨ï¼ˆæ¯æ—¥ä»»åŠ¡ï¼‰

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| openid | string | æ˜¯ | ç”¨æˆ·ï¼ˆæ™®é€šç´¢å¼•ï¼‰ |
| taskId | string | æ˜¯ | ä»»åŠ¡ ID |
| name | string | æ˜¯ | ä»»åŠ¡åç§° |
| progress | number | æ˜¯ | å½“å‰è¿›åº¦ |
| target | number | æ˜¯ | ç›®æ ‡è¿›åº¦ |
| completed | boolean | æ˜¯ | æ˜¯å¦å®Œæˆï¼Œé»˜è®¤ false |
| rewards | object | æ˜¯ | å¥–åŠ± {coins, exp} |
| date | string | æ˜¯ | ä»»åŠ¡æ—¥æœŸ YYYY-MM-DD |
| createdAt | number | æ˜¯ | åˆ›å»ºæ—¶é—´æˆ³ |
| completedAt | number | å¦ | å®Œæˆæ—¶é—´æˆ³ |

**ç´¢å¼•ï¼š**
- å¤åˆç´¢å¼•ï¼š(openid, date)

---

## ğŸ“Š æ•°æ®åº“å­—æ®µæ¸…å•ï¼ˆV1 å½“å‰ç‰ˆæœ¬ï¼‰

### pets é›†åˆ

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| _id | string | æ˜¯ | äº‘æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆ |
| openid | string | æ˜¯ | å¾®ä¿¡ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆå»ºå”¯ä¸€ç´¢å¼•ï¼‰ |
| name | string | æ˜¯ | å® ç‰©åç§°ï¼ˆ2~6 å­—ç¬¦ï¼‰ |
| stage | string | æ˜¯ | è¿›åŒ–é˜¶æ®µï¼šbaby / adult / master |
| hunger | number | æ˜¯ | é¥¥é¥¿å€¼ï¼ˆ0~100ï¼Œæ•´æ•°ï¼‰ |
| mood | number | æ˜¯ | å¿ƒæƒ…å€¼ï¼ˆ0~100ï¼Œæ•´æ•°ï¼‰ |
| energy | number | æ˜¯ | ç²¾åŠ›å€¼ï¼ˆ0~100ï¼Œæ•´æ•°ï¼‰ |
| lastUpdate | number | æ˜¯ | ä¸Šæ¬¡ç»“ç®—æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ |
| lastActionAt | number | æ˜¯ | ä¸Šæ¬¡æ“ä½œæ—¶é—´æˆ³ï¼ˆç”¨äºå†·å´ï¼‰ |
| createdAt | number | æ˜¯ | å® ç‰©åˆ›å»ºæ—¶é—´æˆ³ |
| goodStateStartAt | number | å¦ | é«˜çŠ¶æ€èµ·å§‹æ—¶é—´ï¼ˆç”¨äºè¿›åŒ–åˆ¤å®šï¼‰ |
| dead | boolean | æ˜¯ | æ˜¯å¦æ­»äº¡ï¼Œé»˜è®¤ false |
| deadAt | number | å¦ | æ­»äº¡æ—¶é—´æˆ³ |
| version | number | æ˜¯ | ç‰ˆæœ¬å·ï¼ˆç”¨äºä¹è§‚é”ï¼‰ï¼Œé»˜è®¤ 0 |

### åˆå§‹å€¼

```javascript
{
  openid: "ç”¨æˆ·openid",
  name: "ç”¨æˆ·è¾“å…¥",
  stage: "baby",
  hunger: 100,
  mood: 100,
  energy: 100,
  lastUpdate: Date.now(),
  lastActionAt: 0,
  createdAt: Date.now(),
  goodStateStartAt: null,
  dead: false,
  deadAt: null,
  version: 0
}
```

### ç´¢å¼•è®¾è®¡

- **å”¯ä¸€ç´¢å¼•**ï¼šopenidï¼ˆç¡®ä¿ä¸€äººä¸€å® ï¼‰
- **æ™®é€šç´¢å¼•**ï¼šdeadï¼ˆå¯é€‰ï¼Œç”¨äºç»Ÿè®¡ï¼‰

---

æ–‡æ¡£ç‰ˆæœ¬ï¼šv2.0
æœ€åæ›´æ–°ï¼š2024-01-14

**ç‰ˆæœ¬è¯´æ˜ï¼š**
- v1.0ï¼šåˆå§‹ç‰ˆæœ¬ï¼Œå•å® ç‰© MVP
- v1.1ï¼šå®Œå–„æ ¸å¿ƒåŠŸèƒ½
- v2.0ï¼šæ·»åŠ å¤šå® ç‰©ã€å•†åŸã€æˆå°±ç­‰æ‰©å±•è§„åˆ’
